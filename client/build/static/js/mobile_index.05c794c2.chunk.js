(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{130:function(e,t,n){e.exports=n.p+"static/media/netease_16.0c21a08b.ico"},131:function(e,t,n){e.exports=n.p+"static/media/qq_16.2bf5aa3f.ico"},132:function(e,t,n){e.exports=n.p+"static/media/xiami_16.deaf311e.ico"},210:function(e,t,n){e.exports=n.p+"static/media/netease_16.0c21a08b.ico"},211:function(e,t,n){e.exports=n.p+"static/media/qq_16.2bf5aa3f.ico"},212:function(e,t,n){e.exports=n.p+"static/media/xiami_16.deaf311e.ico"},213:function(e,t,n){e.exports=n.p+"static/media/netease_16.0c21a08b.ico"},214:function(e,t,n){e.exports=n.p+"static/media/qq_16.2bf5aa3f.ico"},215:function(e,t,n){e.exports=n.p+"static/media/xiami_16.deaf311e.ico"},35:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var a="http://localhost:8081/",r="#EA7030",o={background:"#222",color:"white"}},437:function(e,t,n){e.exports=n(443)},440:function(e,t,n){},443:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(29),c=n.n(o),i=n(18),l=n(7),s=n(6),u=n(11),p=n(14),f=n(9),d=(n(105),n(46)),h=n.n(d),y=n(52),m=n(37),g=n(35);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var b=function(e){Object(u.a)(n,e);var t=v(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{style:{padding:"10px 9px",borderBottom:"1px solid #DBDBDB"}},r.a.createElement(y.b,{to:"/",style:{textDecoration:"none"}},r.a.createElement("h2",{style:{display:"inline",color:g.c,fontWeight:360}},"Tonzhon Lite")))}}]),n}(a.Component),E=(n(135),n(89));function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var O=n.n(E).a.Search,j=function(e){Object(u.a)(n,e);var t=S(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onSearch=function(e){""!==e&&e!==a.props.keyword&&(a.props.updateSearchKeyword(e),a.props.history.push("/search?keyword=".concat(window.encodeURIComponent(e))))},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props.keyword;return r.a.createElement(O,{placeholder:"\u6b4c\u66f2/\u4e13\u8f91/\u827a\u4eba",defaultValue:e||"",onSearch:this.onSearch,enterButton:!0,size:"large"})}}]),n}(a.Component);var P=Object(m.f)(Object(i.b)((function(e){return{keyword:e.searchKeyword}}),(function(e){return{updateSearchKeyword:function(t){e({type:"UPDATE_SEARCH_KEYWORD",data:t})}}}))(j)),R=(n(154),n(101)),w=n.n(R),I=n(465),x=n(466),k=n(467),A=n(464),C=n(130),_=n.n(C),T=n(131),L=n.n(T),D=n(132),B=n.n(D),U=n(80),N=n.n(U);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Y=function(e){Object(u.a)(n,e);var t=M(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"playOrPause",value:function(e){var t=this;if(e){var n=this.props.playlist.findIndex((function(e){return e.newId===t.props.song.newId}));-1===n?(this.props.addToPlaylist(this.props.song),this.props.updatePlayIndex(this.props.playlist.length)):this.props.updatePlayIndex(n),this.props.updatePlayAction("play")}else this.props.updatePlayAction("pause")}},{key:"render",value:function(){var e=this,t=this.props,n=t.song,a=t.currentSong,o=t.showPlatform,c=!a||a.newId!==n.newId||a.newId===n.newId&&"pause"===this.props.playAction;return r.a.createElement(x.a,{button:!0,onClick:function(){return e.playOrPause(c)},key:n.newId,style:{color:n.hasCopyright?"black":"#aaa",padding:0,borderBottom:"0.1px solid #ccc"}},r.a.createElement(k.a,{primary:n.name,secondary:n.artists.map((function(e){return e.name})).reduce((function(e,t){return e+" / "+t}))}),o&&r.a.createElement(A.a,null,r.a.createElement("img",{src:H[n.platform],alt:"",style:{width:16,height:16}})))}}]),n}(a.Component),H={qq:L.a,netease:_.a,xiami:B.a,kuwo:N.a};var q=Object(i.b)((function(e){return{user:e.user,currentSong:e.playlist[e.playIndex],playlist:e.playlist,playAction:e.playAction}}),(function(e){return{updateUserFavoriteSongs:function(t){return e({type:"UPDATE_FAVORITE_SONGS",data:t})},addToPlaylist:function(t){e({type:"ADD_TO_PLAYLIST",data:t})},updatePlayIndex:function(t){e({type:"UPDATE_PLAY_INDEX",data:t})},updatePlayAction:function(t){e({type:"UPDATE_PLAY_ACTION",data:t})}}}))(Y);function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var K=function(e){Object(u.a)(n,e);var t=V(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.songs,n=e.showPlatform;return r.a.createElement(I.a,null,t.map((function(e){return r.a.createElement(q,{key:e.link,song:e,showPlatform:n})})))}}]),n}(a.Component),z=(n(56),n(32)),F=n.n(z),W=(n(57),n(16)),J=n.n(W),X=n(93),G=n(210),$=n.n(G),Q=n(211),Z=n.n(Q),ee=n(212),te=n.n(ee);function ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var ae=function(e){Object(u.a)(n,e);var t=ne(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props.provider,t=oe[e],n=t.themeColor,a=t.logo;return r.a.createElement("div",{style:Object(X.a)({},re.wrapper,{borderColor:n})},r.a.createElement(F.a,{type:"flex",align:"middle"},r.a.createElement(J.a,{span:2},r.a.createElement("img",{src:a,alt:e})),r.a.createElement(J.a,{span:16},this.props.pagination),r.a.createElement(J.a,{span:6},this.props.operatingBar)),this.props.children)}}]),n}(a.Component),re={wrapper:{border:"1px solid",borderRadius:5,padding:"8px 8px 0",marginBottom:15}},oe={netease:{themeColor:"#C20C0C",logo:$.a},qq:{themeColor:"#2caf6f",logo:Z.a},xiami:{themeColor:"#FA8723",logo:te.a},kuwo:{themeColor:"#ffe443",logo:N.a}},ce=ae,ie=(n(59),n(30)),le=n.n(ie),se=n(472),ue=(n(100),n(49)),pe=n.n(ue),fe=n(470);function de(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var he=function(e){Object(u.a)(n,e);var t=de(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleClick=function(){a.props.addToPlaylist(a.props.data),pe.a.open({message:"\u5df2\u6dfb\u52a0\u81f3\u64ad\u653e\u5217\u8868"})},a}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(le.a,{title:"\u6dfb\u52a0\u5230\u64ad\u653e\u5217\u8868",onClick:this.handleClick,shape:"circle",icon:r.a.createElement(fe.a,null),style:{backgroundColor:"rgba(0, 0, 0, 0)"}})}}]),n}(a.Component);var ye=Object(i.b)(null,(function(e){return{addToPlaylist:function(t){e({type:"ADD_TO_PLAYLIST",data:t})}}}))(he);function me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var ge=function(e){Object(u.a)(n,e);var t=me(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(F.a,{type:"flex",align:"middle",justify:"space-around",gutter:5},r.a.createElement(J.a,null,r.a.createElement(le.a,{icon:r.a.createElement(se.a,null),shape:"circle",onClick:function(){return e.props.playSongList(e.props.songs)}})),r.a.createElement(J.a,null,r.a.createElement(ye,{data:this.props.songs})))}}]),n}(a.Component);var ve=Object(i.b)(null,(function(e){return{playSongList:function(t){e({type:"NEW_PLAYLIST",data:t}),e({type:"UPDATE_PLAY_INDEX",data:0})}}}))(ge);function be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Ee=function(e){Object(u.a)(n,e);var t=be(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onPageChange=function(e){var t=a.props,n=t.provider,r=t.keyword,o=t.onResultResponded;fetch("/api/search?provider=".concat(n,"&keyword=").concat(r,"&page=").concat(e)).then((function(e){return e.json()})).then((function(e){o(n,e)})).catch((function(e){console.log("err ",e)}))},a}return Object(s.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.result,a=t.searchType,o=t.provider;return e=n.searchSuccess?r.a.createElement(K,{songs:n.data.songs}):r.a.createElement("h3",null,n.message),r.a.createElement(ce,{provider:o,pagination:n.searchSuccess&&r.a.createElement(w.a,{simple:!0,onChange:this.onPageChange,defaultPageSize:4,total:n.data.totalCount}),operatingBar:n.searchSuccess&&"song"===a&&r.a.createElement(ve,{songs:n.data.songs})},e)}}]),n}(a.Component);var Se=Object(i.b)((function(e){return{keyword:e.searchKeyword}}),(function(e){return{onResultResponded:function(t,n){e({type:"UPDATE_SEARCH_RESULTS",provider:t,data:n})}}}))(Ee),Oe=n(129),je=n.n(Oe);function Pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Re=function(e){Object(u.a)(n,e);var t=Pe(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location,n=e.keywordFromStore,a=t.search.slice(1),r=je.a.parse(a),o=r.keyword,c=r.type;o&&c&&window.encodeURIComponent(o)!==n&&this.props.updateSearchKeyword(o)}},{key:"render",value:function(){return null}}]),n}(a.Component);var we=Object(i.b)((function(e){return{keywordFromStore:e.searchKeyword}}),(function(e){return{updateSearchKeyword:function(t){e({type:"UPDATE_SEARCH_PARAMETERS",data:t})}}}))(Re);function Ie(){return r.a.createElement("h1",null,"Oh, 404...")}var xe=n(8);function ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Ae=function(e){Object(u.a)(n,e);var t=ke(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={topSongs:[]},a}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.searchResults;n!==e.searchResults&&(0===Object.keys(n).length&&this.setState({topSongs:[]}),Object.keys(n).forEach((function(e){t.state.topSongs.every((function(t){return t.platform!==e}))&&n[e].searchSuccess&&t.setState({topSongs:[].concat(Object(xe.a)(t.state.topSongs),[n[e].data.songs[0]])})})))}},{key:"render",value:function(){return 0===this.state.topSongs.length?null:r.a.createElement("div",{style:{padding:"0 8px",marginBottom:15,backgroundColor:"rgba(240,240,240,0.5)",borderRadius:5}},r.a.createElement(K,{songs:this.state.topSongs,showPlatform:!0}))}}]),n}(a.Component);var Ce=Object(i.b)((function(e){return{searchResults:e.searchResults}}))(Ae),_e=(n(198),n(133)),Te=n.n(_e),Le=(n(113),n(88)),De=n.n(Le),Be=(n(196),n(103)),Ue=n.n(Be),Ne=n(25),Me=n(473),Ye=n(476),He=n(474),qe=n(475),Ve=n(478),Ke=n(71),ze=(n(99),n(58)),Fe=n.n(ze),We=n(468);function Je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Xe=function(e){Object(u.a)(n,e);var t=Je(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).changeCurrentSong=function(){var e=a.props.playlist.findIndex((function(e){return e.newId===a.props.song.newId}));-1===e?(a.props.addToPlaylist(a.props.song),a.props.updatePlayIndex(a.props.playlist.length)):a.props.updatePlayIndex(e)},a.deleteFromPlaylist=function(){var e=a.props.playlist.findIndex((function(e){return e.newId===a.props.song.newId}));e+1===a.props.playlist.length&&a.props.updatePlayIndex(0),a.props.deleteSongInPlaylist(e,a.props.playIndex)},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.song;e.currentSong;return r.a.createElement(F.a,{type:"flex",align:"middle",style:{width:"100%",padding:"0 10px"},onClick:this.changeCurrentSong},r.a.createElement(J.a,{span:12},r.a.createElement("div",{className:"nowrap"},r.a.createElement("span",null,t.name))),r.a.createElement(J.a,{span:8},r.a.createElement("div",{className:"nowrap"},t.artists.map((function(e){return e.name})).reduce((function(e,t){return e+" / "+t})))),r.a.createElement(J.a,{span:2},r.a.createElement("img",{src:Ge[t.platform],alt:t.platform})),r.a.createElement(J.a,{span:2},r.a.createElement(le.a,{title:"\u5220\u9664",onClick:this.deleteFromPlaylist,icon:r.a.createElement(We.a,null),style:{border:"none"}})))}}]),n}(a.Component),Ge={qq:L.a,netease:_.a,xiami:B.a,kuwo:N.a};var $e=Object(i.b)((function(e){return{currentSong:e.playlist[e.playIndex],playlist:e.playlist,playIndex:e.playIndex}}),(function(e){return{addToPlaylist:function(t){e({type:"ADD_TO_PLAYLIST",data:t})},updatePlayIndex:function(t){e({type:"UPDATE_PLAY_INDEX",data:t})},deleteSongInPlaylist:function(t,n){e({type:"DELETE_SONG_IN_PLAYLIST",data:t}),t<n&&e({type:"UPDATE_PLAY_INDEX",data:n-1})}}}))(Xe);function Qe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var Ze=function(e){Object(u.a)(n,e);var t=Qe(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(Te.a,{visible:this.props.visible,placement:"bottom",mask:!1,height:540,closable:!1,bodyStyle:{padding:"0 0 75px 0"},style:{zIndex:10},title:r.a.createElement(F.a,{type:"flex",align:"middle",style:et.header},r.a.createElement(J.a,{span:18},"\u64ad\u653e\u5217\u8868"),r.a.createElement(J.a,{span:6},r.a.createElement(le.a,{icon:r.a.createElement(We.a,null),onClick:this.props.clearPlayingList},"\u6e05\u7a7a")))},r.a.createElement("div",{style:et.wrapper},r.a.createElement("div",{className:"playingList",style:et.list},r.a.createElement(Fe.a,{itemLayout:"horizontal",dataSource:this.props.dataSource,size:"small",renderItem:function(e){return r.a.createElement(Fe.a.Item,{key:"".concat(e.platform).concat(e.originalId)},r.a.createElement($e,{song:e}))}}))))}}]),n}(a.Component),et={list:{overflow:"auto",height:400,padding:"0 10px"}};var tt=Object(i.b)((function(e){return{dataSource:e.playlist}}),(function(e){return{clearPlayingList:function(){e({type:"CLEAR_PLAYLIST"})}}}))(Ze),nt=n(77),at=n(213),rt=n.n(at),ot=n(214),ct=n.n(ot),it=n(215),lt=n.n(it);function st(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}pe.a.config({placement:"bottomRight",bottom:50,duration:3});var ut={loop:r.a.createElement(Ke.b,{className:"player-icon"}),single:r.a.createElement(Ke.c,{className:"player-icon"}),shuffle:r.a.createElement(Ke.d,{className:"player-icon"})},pt=["loop","single","shuffle"],ft={loop:"\u5faa\u73af",single:"\u5355\u66f2\u5faa\u73af",shuffle:"\u968f\u673a"},dt=Boolean(navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)),ht=function(e){Object(u.a)(n,e);var t=st(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).getSongSourceAndPlay=function(e){a.getSongSource(e.platform,e.originalId,(function(){dt||a.play()}))},a.switchPlayerDetailsVisible=function(){a.setState({playerDetailsVisible:!a.state.playerDetailsVisible})},a.hidePlayerDetails=function(){a.setState({playerDetailsVisible:!1})},a.state={getMusicUrlStatus:"notYet",playStatus:"pausing",playMode:localStorage.getItem("playMode")||"loop",songSource:null,playProgress:0,playerDetailsVisible:!1,playingListVisible:!1},a.playOrPause=a.playOrPause.bind(Object(Ne.a)(a)),a.play=a.play.bind(Object(Ne.a)(a)),a.pause=a.pause.bind(Object(Ne.a)(a)),a.getSongSource=a.getSongSource.bind(Object(Ne.a)(a)),a.changePlayProgress=a.changePlayProgress.bind(Object(Ne.a)(a)),a.playNext=a.playNext.bind(Object(Ne.a)(a)),a.switchPlayMode=a.switchPlayMode.bind(Object(Ne.a)(a)),a.clickPlaylistBtn=a.clickPlaylistBtn.bind(Object(Ne.a)(a)),a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.audio.addEventListener("loadeddata",(function(){e.setState({songLoaded:!0,songDuration:e.audio.duration,playProgress:0})})),this.audio.addEventListener("play",(function(){e.interval&&clearInterval(e.interval),e.interval=setInterval((function(){e.setState({playProgress:e.audio.currentTime})}),1e3)})),this.audio.addEventListener("pause",(function(){e.interval&&clearInterval(e.interval)})),this.audio.addEventListener("ended",(function(){clearInterval(e.interval),e.setState({playProgress:e.audio.currentTime},(function(){e.playNext("forward")}))}))}},{key:"componentDidUpdate",value:function(e){var t=e.currentSong,n=this.props.currentSong;n?(t&&n.newId!==t.newId||!t)&&(this.audio.pause(),this.setState({songSource:null,songLoaded:!1,playProgress:0}),this.getSongSourceAndPlay(n)):t&&this.setState({songSource:null,songLoaded:!1,playProgress:0})}},{key:"playOrPause",value:function(){var e=this.state.playStatus;if("pausing"===e)if(this.state.songSource)this.play();else{var t=this.props.currentSong;this.getSongSourceAndPlay(t)}else"playing"===e&&this.pause()}},{key:"play",value:function(){this.audio.play(),this.setState({playStatus:"playing"})}},{key:"pause",value:function(){this.audio.pause(),this.setState({playStatus:"pausing"})}},{key:"getSongSource",value:function(e,t,n){var a=this;this.setState({getMusicUrlStatus:"started"}),fetch("/api/song_source/".concat(e,"/").concat(t)).then((function(e){return e.json()})).then((function(e){"ok"===e.status?a.setState({getMusicUrlStatus:"ok",songSource:e.data.songSource,songLoaded:!1},n):(a.setState({getMusicUrlStatus:"failed"}),pe.a.open({message:"\u64ad\u653e\u5931\u8d25"}))})).catch((function(e){a.setState({getMusicUrlStatus:"failed"}),pe.a.open({message:"\u64ad\u653e\u5931\u8d25"})}))}},{key:"changePlayProgress",value:function(e){this.audio.currentTime=e,this.setState({playProgress:e})}},{key:"playNext",value:function(e){"playing"===this.state.playStatus&&this.pause();var t=this.props,n=t.currentSong,a=t.playlist,r=this.state.playMode;"single"===r||1===a.length?(this.audio.currentTime=0,this.play()):this.props.changePlayIndex(n,a,r,e)}},{key:"switchPlayMode",value:function(){var e=pt.indexOf(this.state.playMode),t=pt[e+1]||pt[0];localStorage.setItem("playMode",t),this.setState({playMode:t})}},{key:"clickPlaylistBtn",value:function(){this.setState({playingListVisible:!this.state.playingListVisible})}},{key:"render",value:function(){var e=this,t=this.state,n=t.getMusicUrlStatus,a=t.playStatus,o=this.props,c=o.currentSong,i=(o.playlist,Object(nt.a)(this.state.playProgress)),l=Object(nt.a)(this.state.songDuration);return r.a.createElement("div",{style:yt.player,id:"music-player"},r.a.createElement("audio",{src:this.state.songSource,ref:function(t){e.audio=t}}),r.a.createElement(Te.a,{visible:this.state.playerDetailsVisible,title:c&&c.name,onCancel:this.handleCancel,placement:"bottom",mask:!1,onClose:this.hidePlayerDetails,closable:!1},r.a.createElement("div",{style:{textAlign:"right"}},this.state.songLoaded?"".concat(i," / ").concat(l):"00:00 / 00:00"),r.a.createElement(Ue.a,{min:0,max:this.state.songDuration?parseInt(this.state.songDuration):0,value:this.state.playProgress,tipFormatter:function(e){return Object(nt.a)(e)},onChange:this.changePlayProgress,disabled:!this.state.songSource,style:{margin:"0 0 12px 0"}}),r.a.createElement(F.a,{type:"flex",align:"middle",className:"container",style:{marginBottom:10}},r.a.createElement(J.a,{span:20},r.a.createElement(le.a,{shape:"circle",icon:r.a.createElement(Me.a,null),onClick:function(){return e.playNext("backward")},style:{marginRight:20}}),r.a.createElement(le.a,{shape:"circle",icon:r.a.createElement(Ye.a,null),onClick:function(){return e.playNext("forward")}})),r.a.createElement(J.a,{span:4},r.a.createElement(De.a,{title:ft[this.state.playMode]},r.a.createElement("a",{onClick:this.switchPlayMode,style:{float:"right"}},ut[this.state.playMode]))))),r.a.createElement(F.a,{type:"flex",align:"middle",justify:"space-between"},r.a.createElement(J.a,{span:14,onClick:this.switchPlayerDetailsVisible},c&&r.a.createElement("div",null,r.a.createElement("h3",{className:"nowrap",style:{color:"white"}},c.name),r.a.createElement("h5",{className:"nowrap",style:{color:"white"}},c.artists.map((function(e){return e.name})).reduce((function(e,t){return e+"/"+t}))))),r.a.createElement(J.a,{span:4},c&&r.a.createElement("img",{src:mt[c.platform],alt:c.platform})),r.a.createElement(J.a,{span:3},r.a.createElement(le.a,{ghost:!0,shape:"circle",icon:"notYet"===n?r.a.createElement(se.a,null):"started"===n?r.a.createElement(He.a,null):"ok"===n&&"playing"===a?r.a.createElement(qe.a,null):r.a.createElement(se.a,null),onClick:this.playOrPause,disabled:!c})),r.a.createElement(J.a,{span:3,style:{float:"right"}},r.a.createElement(le.a,{ghost:!0,icon:r.a.createElement(Ve.a,null),onClick:this.clickPlaylistBtn,title:"\u64ad\u653e\u5217\u8868",style:{float:"right"}}))),r.a.createElement(tt,{visible:this.state.playingListVisible}))}}]),n}(a.Component),yt={player:{position:"fixed",bottom:0,padding:"10px",width:"100%",backgroundColor:g.a.background,color:g.a.color,zIndex:1001}},mt={qq:ct.a,netease:rt.a,xiami:lt.a,kuwo:N.a};var gt=Object(i.b)((function(e){return{currentSong:e.playlist[e.playIndex],playlist:e.playlist}}),(function(e){return{changePlayIndex:function(t,n,a,r){var o,c=n.findIndex((function(e){return e.newId===t.newId}));if("loop"===a)"forward"===r?o=n[c+1]?c+1:0:"backward"===r&&(o=n[c-1]?c-1:n.length-1);else if("shuffle"===a)do{o=Math.floor(Math.random()*n.length)}while(o===c);void 0!==o&&e({type:"UPDATE_PLAY_INDEX",data:o})}}}))(ht);n(440);function vt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(p.a)(this,n)}}var bt=h.a.Header,Et=h.a.Content,St=function(e){Object(u.a)(n,e);var t=vt(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.searchStatus,n=e.searchResults;return r.a.createElement(y.a,{basename:"/"},r.a.createElement(h.a,null,r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/search",component:we})),r.a.createElement(bt,{style:{width:"100%",zIndex:1040}},r.a.createElement(b,null)),r.a.createElement(Et,null,r.a.createElement("div",{style:{marginTop:5,padding:"10px 2px 0",marginBottom:80}},r.a.createElement("div",{style:{marginBottom:10}},r.a.createElement(P,null)),r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/"}),r.a.createElement(m.a,{path:"/search",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,null),Object.keys(n).map((function(e){return r.a.createElement(Se,{result:n[e],provider:e,key:e})})),r.a.createElement("div",{className:"loading-anim-wrapper"},"searching"===t&&r.a.createElement(He.a,{style:{fontSize:30,color:g.c}})))}}),r.a.createElement(m.a,{path:"/*",render:Ie})))),r.a.createElement(gt,null)))}}]),n}(a.Component);var Ot=Object(i.b)((function(e){return{searchStatus:e.searchStatus,searchResults:e.searchResults}}))(St),jt=n(79),Pt=localStorage.getItem("searchHistory");!Pt||Pt.includes("[")||Pt.includes("]")||(Pt=!1);var Rt=Pt&&JSON.parse(Pt)||[],wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SEARCH_HISTORY":var n=t.data;return(Pt=Object(xe.a)(e)).includes(n)&&Pt.splice(Pt.indexOf(n),1),(Pt=[n].concat(Object(xe.a)(Pt))).length>10&&(Pt=Pt.splice(0,10)),localStorage.setItem("searchHistory",JSON.stringify(Pt)),Pt;case"CLEAR_SEARCH_HISTORY":return localStorage.setItem("searchHistory",""),[];default:return e}},It=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not_searched_yet",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SEARCH_STATUS":return t.data;default:return e}},xt=n(4),kt={},At=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SEARCH_RESULTS":return Object(X.a)({},e,Object(xt.a)({},t.provider,t.data));case"CLEAR_RESULTS":return{};default:return e}},Ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SEARCH_KEYWORD":return t.data;default:return e}},_t=localStorage.getItem("playlist"),Tt=_t&&JSON.parse(_t)||[],Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TO_PLAYLIST":var n=t.data;return Array.isArray(n)?(n=n.filter((function(t){return e.every((function(e){return e.newId!==t.newId}))})),_t=e.concat(n)):"object"===typeof n&&(_t=e.findIndex((function(e){return e.newId===n.newId}))>-1?e:[].concat(Object(xe.a)(e),[n])),localStorage.setItem("playlist",JSON.stringify(_t)),_t;case"NEW_PLAYLIST":return _t=t.data,localStorage.setItem("playlist",JSON.stringify(_t)),_t;case"DELETE_SONG_IN_PLAYLIST":return(_t=Array.from(e)).splice(t.data,1),localStorage.setItem("playlist",JSON.stringify(_t)),_t;case"CLEAR_PLAYLIST":return localStorage.setItem("playlist",""),[];default:return e}},Dt=localStorage.getItem("playIndex"),Bt=Dt?Number(Dt):0,Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PLAY_INDEX":return Dt=t.data,localStorage.setItem("playIndex",Dt),Dt;case"CLEAR_PLAY_INDEX":return localStorage.setItem("playIndex",""),0;default:return e}},Nt=Object(jt.a)({providers:function(){return["netease","qq","kuwo"]},searchHistory:wt,searchStatus:It,searchResults:At,searchKeyword:Ct,playlist:Lt,playIndex:Ut}),Mt=Object(jt.b)(Nt),Yt=Mt.getState(),Ht=Yt.providers,qt=Yt.searchKeyword;Mt.subscribe((function(){var e=Mt.getState().searchKeyword;if(qt!==e){qt=e,Ft(e),Vt();var t=0;Ht.forEach((function(n){fetch("/api/search?provider=".concat(n,"&keyword=").concat(window.encodeURIComponent(e)),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){Kt(n,e),++t===Ht.length&&zt()})).catch((function(e){console.log("err ",e)}))}))}}));var Vt=function(){Mt.dispatch({type:"CLEAR_RESULTS"}),Mt.dispatch({type:"UPDATE_SEARCH_STATUS",data:"searching"})},Kt=function(e,t){Mt.dispatch({type:"UPDATE_SEARCH_RESULTS",provider:e,data:t})},zt=function(){Mt.dispatch({type:"UPDATE_SEARCH_STATUS",data:"searched"})},Ft=function(e){Mt.dispatch({type:"UPDATE_SEARCH_HISTORY",data:e})},Wt=Mt,Jt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Xt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(i.a,{store:Wt},r.a.createElement(Ot,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("http://localhost:8081",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("http://localhost:8081","/service-worker.js");Jt?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Xt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):Xt(e)}))}}()},77:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){e=Math.floor(e);var t=Math.floor(e/60);return e%=60,t<10&&(t="0".concat(t)),e<10&&(e="0".concat(e)),"".concat(t,":").concat(e)}},80:function(e,t,n){e.exports=n.p+"static/media/kuwo_16.86fba451.ico"}},[[437,4,0,6]]]);